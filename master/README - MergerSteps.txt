The vocabulary merge process combines the vocabularies from a run of the VertNet Migrator Toolkit (or from an update to vocabularies independent of the toolkit) with the accumulated master vocabulary authority. To work with the merger, the version of the master vocabularies file used must be compatible with that of the merger. To be sure of this, always use the latest version of the VocabulariesMaster.mdb file (archive downloadable from https://github.com/tucotuco/DwCVocabs/tree/master/master/VocabulariesMaster.zip) in the directory c:\tempvertnetprocessing\source when running a migrator.

Merging a vocabulary with the master vocabulary

1) In the directory c:\tempvertnetprocessing\source, put a copy of a newly contributed VocabulariesMaster.mdb file that has in it the resolved vocabularies following a specific migrator run. All master vocabulary files will necessarily have this same file name (VocabulariesMaster.mdb) when part of a running migrator. It is important to distinguish this new file by changing its name before it is contributed. It is recommended to name it using the following pattern:
Vocabularies-new-[dataset]-[name of person who resolved the vocabs]
2) Put a copy of the latest master vocabulary archive (VocabulariesMaster.zip) from https://github.com/tucotuco/DwCVocabs/tree/master/master/VocabulariesMaster.zip into the directory c:\tempvertnetprocessing\source and extract the file VocabulariesMaster.mdb from it to this same directory. This master file is the one that is contains the authoritative version of the vocabularies - the one that accumulates vocabularies from all other versions.
3) Put a copy of the latest merger archive (VocabulariesMerger.zip) from https://github.com/tucotuco/DwCVocabs/tree/master/master/VocabulariesMerger.zip in the directory c:\tempvertnetprocessing\source and extract the file VocabulariesMerger.mdb to this same directory.
4) Open the Access database VocabulariesMerger.mdb. Switch to the view of macros. 
5) Run the macro called "Clean". This macro removes initializes the merger for use. This step is necessary if the merger is being reused without downloading a fresh copy as in step 3).
6) Run the macro called "1) Gather old and new Vocabs". This macro adds the vocabulary records from the file Vocabularies-new.mdb that are new, or that were unchecked in the master vocabularies but are checked in the new vocabularies.
7) Run the macro called "2) Resolve Geography". This macro analyses which geography records have changed between the master vocabulary file and the new vocabulary file and creates records from both that can be used for comparison. When the macro is finished, the table called "ChangedGeogs" is opened. The table shows the two versions of every record that needs to be resolved. Pick the best record (only) of each pair by clicking on the check box labelled "pickme". Resolve all pairs by picking one of them before proceeding to the next step. It is ok to make further corrections to the record that is picked. If you must pause before resolving all of the record pairs, it is OK to close the merger, but when you resume, do not run this or any other macros. Instead, open the table called "ChangedGeogs" and proceed until all pairs have exactly one version picked.
8) When the previous step is complete, run the macro called "3) Adopt Resolved Geography". This macro updates the master vocabulary from the best versions of all geography records that were picked in the previous step.
9) Run the macro called "4) Resolve Classifications". This macro analyses which classification records have changed between the master vocabulary file and the new vocabulary file and creates records from both that can be used for comparison. When the macro is finished, the table called "ChangedClassifications" is opened. The table shows the two versions of every record that needs to be resolved. Pick the best record (only) of each pair by clicking on the check box labelled "pickme". Resolve all pairs by picking one of them before proceeding to the next step. It is ok to make further corrections to the record that is picked. If you must pause before resolving all of the record pairs, it is OK to close the merger, but when you resume, do not run this or any other macros. Instead, open the table called "ChangedClassifications" and proceed until all pairs have exactly one version picked.
10) When the previous step is complete, run the macro called "5) Adopt Resolved Geography". This macro updates the master vocabulary from the best versions of all classification records that were picked in the previous step.
11) Run the macro called "6) Resolve other vocabs". As with geography and classifications in steps 8) and 10, this analyses all other vocabularies and present record pairs for adoption by opening a table for each vocabulary. Use the same method of picking the best record from the pair. Close each table when all of its pairs have been resolved. Proceed until all tables are closed. If you must pause before finishing this step, make note of which vocabularies have not yet been resolved. When you return to resolving vocabularies, you need only open the "Changed" tables for those that have not yet been finished. Do not run any other macros before this step is complete.
12) When the previous step is complete, run the macro called "7) Adopt Other Resolved Vocabs". This macro updates the master vocabulary from the best versions of each pair of records from each of the vocabularies that were resolved in the previous step.
13) Special for Master Vocabulary Managers: When all the previous steps are complete, zip the file VocabulariesMaster.mdb as VocabulariesMaster.zip, copy the archive to the master folder in the local toolkit repository, git commit the change with comments about which data set (or other activity) contributed new vocabularies and git push the commit to the remote repository.
14) Special for Merger Managers: If changes that need to be saved were made to the queries or functions in the file VocabulariesMerger.mdb (rather that just running the merger normally with steps 5 through 12), run the macro called "Clean", then close the merger (it will compact automatically), zip it as VocabulariesMerger.zip, copy the archive to the master folder in the local toolkit repository, git commit the change with comments about what was changed and git push the commit to the remote repository.
